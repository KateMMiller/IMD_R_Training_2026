---
output: 
  html_document:
    fig_caption: false
    css: custom_styles.css
---

#### Importing and saving data
Most of the work we do in R relies on one or more existing datasets that we want to query or summarize, rather than creating our own in R. Importing data in R is therefore an important skill. R can import just about any data type, including CSV and MS Excel files. You can also import tables from MS Access and SQL databases using ODBC drivers. That's beyond the scope of this class, but I can share examples for anyone needing to import from a database. For now, I'll show how to work with CSVs and Excel spreadsheets. 

<details open><summary class = "drop">Import CSV</summary>
We use the `read.csv()` function to import CSVs in R. The `read.csv()` function takes the file path or url to the CSV as input and outputs a data frame containing the data from the CSV. Here we're going to read a CSV from a website, then save that in the data folder of our project.

<p class = "code">Run the following line to import a teaching ACAD wetland dataset from the github repository for this training</p>
```{r read_csv}
# read in the data from ACAD_wetland_data_clean.csv and assign it as a dataframe to the variable "ACAD_wetland"
ACAD_wetland <- read.csv(
  "https://raw.githubusercontent.com/KateMMiller/IMD_R_Training_2026/refs/heads/main/data/ACAD_wetland_data_clean.csv"
  )
```

<p class = "code">View the data in a separate window by running the `View()` function.</p>
```{r view_aw, eval = F}
# View the ACAD_wetland data frame we just created
View(ACAD_wetland)
```

<p class = "code">Or, check out the first few or last few records in your console.</p> 
```{r exp_dat}
# Look at the top 6 rows of the data frame
head(ACAD_wetland)

# Look at the bottom 6 rows of the data frame
tail(ACAD_wetland)
```
</details>
<br>
<details open><summary class = 'drop'>Save CSV</summary>
<p class = "code">Now write the csv to disk and show how to import from your computer. </p>
```{r write_csv}
# Create a data folder in your project
dir.create("./data")

# Write the data frame to your data folder using a relative path. 
# By default, write.csv adds a column with row names that are numbers. I don't
# like that, so I turn that off.
write.csv(ACAD_wetland, "./data/ACAD_wetland_data_clean.csv", row.names = FALSE)
```

<p class = "code">Make sure the writing to disk worked by importing the CSV from your computer</p>

```{r exploredat}
# Read the data frame in using a relative path
ACAD_wetland <- read.csv("./data/ACAD_wetland_data_clean.csv")

# Read in the data frame using full path (at least on my computer)
ACAD_wetland <- read.csv("C:/Users/KMMiller/OneDrive - DOI/NETN/R_Dev/IMD_R_Training_2026/data/ACAD_wetland_data_clean.csv")

```

We'll get very familiar with data frames in this class, but for the moment just know that it's a rectangular table of data with rows and columns. Data frames are typically organized with rows being records or observations (e.g. sampling locations, individual critters, etc.), and columns being variables that characterize those observations (e.g., species, size, date collected, x/Y coordinates). Once you have read the data in, you can take a quick look at its structure by typing the name of the variable it's stored in.

</details>

<details open><summary class = 'drop'>Import from XLSX</summary>
Base R does not have a way to import MS Excel files. The first step for working with Excel files (i.e., files with .xls or .xlsx extensions), therefore, is to install the `readxl` package to import .xlsx files and `writexl` to write files to .xlsx. The `readxl` package has a couple of options for loading Excel spreadsheets, depending on whether the extension is .xls, .xlsx, or unknown, along with options to import different worksheets within a spreadsheet. 

The code below installs the required packages, loads them, then first writes the ACAD_wetland CSV we just imported to an .xlsx. The last step imports the .xslx version of the ACAD wetland data. 

<ol>
<li class = "code">Install packages</li>
```{r, c19b, echo=T, eval=F}
install.packages("readxl") # only need to run once. 
install.packages("writexl")
```

<li class = "code">Load packages</li>
```{r libxl}
library(writexl) # saving xlsx
library(readxl) # importing xlsx
```

<li class = "code">Write CSV to .xlsx to data folder. Doing it this way to keep this training stand-alone.</li>
```{r writexl}
write_xlsx(ACAD_wetland, "./data/ACAD_wetland_data_clean.xlsx")
```

<li class = "code">Import spreadsheet. Note that the default settings import the first sheet, so I didn't really 
need to specify the sheet below. I included the sheet argument to show how it's done.</li>
```{r, c19dd, echo=T}
ACAD_wetxls <- read_xlsx(path = "./data/ACAD_wetland_data_clean.xlsx", sheet = "Sheet1") 
```

<li class = "code">View top 6 rows to check the data</li>
```{r, c19e, echo=T}
head(ACAD_wetxls)
```
</ol>
</details>
<br>
